<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Exportar Tabela com autoTable</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-family: Arial, sans-serif;
            font-size: 14px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #4CAF50;
            color: white;
            position: sticky;
            top: 0;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .header-row {
            background-color: #2E8B57;
        }

        .cidade {
            font-weight: bold;
        }

        .data-header {
            background-color: #3CB371;
            font-weight: bold;
            text-align: center;
        }

        .resolvido-sim {
            color: green;
            font-weight: bold;
        }

        .resolvido-nao {
            color: #CC0000;
        }

        .card-ies {
            background-color: #E6F7FF;
        }

        #pdf-button {
            padding: 10px 20px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 0;
        }

        .data-cell {
            background-color: #d0f0c0;
            /* verde claro */
            font-weight: bold;
        }
    </style>
</head>

<body>

    <button onclick="exportarPDF()">Exportar PDF</button>

    <table id="minhaTabela">
        <thead>
            <tr>
                <th>Data</th>
                <th>Nº</th>
                <th>Cidade</th>
                <th>Perfil</th>
                <th>Descrição do Chamado</th>
                <th>Gerou Card</th>
                <th>Resolvido</th>
                <th>Responsável</th>
            </tr>
        </thead>
        <tbody>
            <!-- SEGUNDA 07/04/2025 -->
            <tr>
                <td class="data-cell" rowspan="40">SEGUNDA<br>07/04/2025</td>
                <td>1</td>
                <td class="cidade">SM</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como desabilitar o histórico de horário para liberar datas anteriores a criação
                    do horário</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <!-- A célula de data não está aqui por causa do rowspan -->
                <td>2</td>
                <td class="cidade">QUIPAPÁ</td>
                <td>Secretaria</td>
                <td>Orientei com relação a frequência dos alunos no sistema de uma professora</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>3</td>
                <td class="cidade">BOA VENTURA</td>
                <td>ADM</td>
                <td>Orientação referente a inserção de algumas habilidades no sistema para o infantil</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>4</td>
                <td class="cidade">SM</td>
                <td>Secretário</td>
                <td>Registrei o card IES-2630 referente a verificação de registro de aula em turma complementar</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>5</td>
                <td class="cidade">DIAMANTE</td>
                <td>Secretaria</td>
                <td>Gerei o desempenho de algumas turmas de uma escola</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>6</td>
                <td class="cidade">UMARIZAL</td>
                <td>Secretaria</td>
                <td>Solicitei para @luan a liberação do campo para organizar uma turma em ordens</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>7</td>
                <td class="cidade">AREIAL</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como realizar a edição de justificativa de falta de uma aluna</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>8</td>
                <td class="cidade">SJCAIANA</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como realizar o cadastro de dia letivo especial</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>9</td>
                <td class="cidade">SERIDÓ</td>
                <td>Secretaria</td>
                <td>Solicitei para @luan a liberação do campo para organizar uma turma em ordens</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>10</td>
                <td class="cidade">SJLT</td>
                <td>ADM</td>
                <td>Registrei o card IES-2631 referente a exclusão de modelo de horário para cadastrar com o correto
                </td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>11</td>
                <td class="cidade">BOA VENTURA</td>
                <td>ADM</td>
                <td>Orientei com relação a data de matrículas dos alunos para lançamento de frequência no diário</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>12</td>
                <td class="cidade">SJCAIANA</td>
                <td>ADM</td>
                <td>Registrei o card IES-2631 referente a verificação de criação de diários</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>13</td>
                <td class="cidade">UMBUZEIRO</td>
                <td>Professor</td>
                <td>Orientei com relação a recuperação de senha, o mesmo não conseguia acessar</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>14</td>
                <td class="cidade">CAJAZEIRINHAS</td>
                <td>ADM</td>
                <td>Registrei o card IES-2631 referente a adição de aulas no modelo para turmas do integral</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>15</td>
                <td class="cidade">UMARIZAL</td>
                <td>Professor</td>
                <td>Orientei com relação a recuperação de senha, o mesmo não conseguia acessar</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>16</td>
                <td class="cidade">VENHA VER</td>
                <td>Secretaria</td>
                <td>Registrei o card IES-2631 referente a alteração de turno de turma para integral</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>17</td>
                <td class="cidade">JURU</td>
                <td>Secretaria</td>
                <td>Orientação referente ao registro de aulas de turma especial</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>18</td>
                <td class="cidade">SH</td>
                <td>Secretário</td>
                <td>Orientação referente ao primeiro acesso de alguns professores</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>19</td>
                <td class="cidade">TRIUNFO</td>
                <td>ADM</td>
                <td>Orientação referente ao período letivo anual para registros dos professores</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>20</td>
                <td class="cidade">PEDRA BRANCA</td>
                <td>ADM</td>
                <td>Unifiquei a senha de uma professora que era responsável</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>21</td>
                <td class="cidade">BARRA DSR</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como realizar a duplicação de aulas entre diários</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>22</td>
                <td class="cidade">SCBV</td>
                <td>ADM</td>
                <td>Criei um modelo de horário para EJA-Noite</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>23</td>
                <td class="cidade">SJRP</td>
                <td>Secretário</td>
                <td>Registrei o card IES-2335 referente a verificação de emissão de relatório de registros no perfil
                    secretário</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>24</td>
                <td class="cidade">UMARIZAL</td>
                <td>Secretaria</td>
                <td>Registrei o card IES-2335 referente a alteração de turno na turma para integral e adição aulas no
                    modelo para se enquadrar</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>25</td>
                <td class="cidade">BARRA DSR</td>
                <td>Secretaria</td>
                <td>Pedi a @weine filho que gerasse os desempenhos de ensino religioso de uma escola</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>26</td>
                <td class="cidade">BARRA DSR</td>
                <td>Professor</td>
                <td>Orientei com relação a recuperação de senha, o mesmo não conseguia acessar</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>27</td>
                <td class="cidade">SJLT</td>
                <td>Secretaria</td>
                <td>Orientei com relação ao registro de frequência de dias de fevereiro, a mesma relatou que alguns
                    professores não estavam conseguindo, fiz um vídeo mostrando que estava normal</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>28</td>
                <td class="cidade">VENHA VER</td>
                <td>Secretaria</td>
                <td>Orientação referente a criação de histórico de anos anteriores</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>29</td>
                <td class="cidade">BAYEUX</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como realizar a criação de diários</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>30</td>
                <td class="cidade">QUIPAPÁ</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como emitir a ficha individual de aluno transferido</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>31</td>
                <td class="cidade">SERIDÓ</td>
                <td>ADM</td>
                <td>Enviei os passos de como emitir o comprovante de matrícula para sair o acesso dos responsáveis e de
                    como tirar o relatório de distorção por alunos</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>32</td>
                <td class="cidade">BAYEUX</td>
                <td>Secretário</td>
                <td>Enviei os passos de como alterar a data de matrícula de alunos para os professores conseguir lançar
                    as frequências</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>33</td>
                <td class="cidade">BAYEUX</td>
                <td>Coordenador</td>
                <td>Enviei alguns vídeos mostrando o gerenciamento de AEE para um coordenador de turma especial da
                    secretaria de educação</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>34</td>
                <td class="cidade">MULUNGU</td>
                <td>ADM</td>
                <td>Registrei o card IES-2335 referente a retirada de série e uma turma e colocar em outra</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>35</td>
                <td class="cidade">SJLT</td>
                <td>ADM</td>
                <td>Registrei o card IES-2335 referente a inserção de aulas no modelo de horário</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>36</td>
                <td class="cidade">SJCAINA</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como desabilitar o histórico de horário para liberar datas anteriores</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>37</td>
                <td class="cidade">LASTRO</td>
                <td>Secretaria</td>
                <td>Vinculei as turmas da EJA a uma escola para criação</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>38</td>
                <td class="cidade">SOLEDADE</td>
                <td>Secretaria</td>
                <td>Enviei os passos de como desabilitar o histórico de horário para liberar datas anteriores</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr>
                <td>39</td>
                <td class="cidade">SM</td>
                <td>Secretaria</td>
                <td>Orientação referente a data de matrícula de alunos para lançamento de frequência nos diários</td>
                <td>Não</td>
                <td class="resolvido-nao">Não</td>
                <td>Júnior Araújo</td>
            </tr>
            <tr class="card-ies">
                <td>40</td>
                <td class="cidade">PEDRA BRANCA</td>
                <td>Professora</td>
                <td>Registrei o card IES-2639 referente a listagem de habilidades em diário</td>
                <td class="resolvido-sim">Sim</td>
                <td class="resolvido-sim">Sim</td>
                <td>Júnior Araújo</td>
            </tr>
</head>
<body>

<h2>Análise de Atendimentos</h2>

<table>
    <thead>
        <tr>
            <th>Categoria</th>
            <th>Resultado</th>
            <th>Quantidade</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Município mais atendido</td>
            <td>SOLEDADE e SM (empate)</td>
            <td>1 cada</td>
        </tr>
        <tr class="destaque">
            <td>Perfil mais atendido</td>
            <td>Secretaria</td>
            <td>2</td>
        </tr>
        <tr>
            <td>Tipo de atendimento mais comum</td>
            <td>Assuntos relacionados a diários escolares</td>
            <td>2</td>
        </tr>
    </tbody>
</table>

<div class="resumo">
    <h3>Principais Conclusões:</h3>
    <ul>
        <li><strong>Secretaria</strong> foi o perfil que mais solicitou atendimento (2 chamados).</li>
        <li><strong>SOLEDADE e SM</strong> tiveram a mesma quantidade de atendimentos (1 cada).</li>
        <li>O tema mais recorrente foi <strong>"diários escolares"</strong> (em 2 dos 3 registros).</li>
    </ul>
</div>

</body>
</html>
        </tbody>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <script>
        async function exportarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('landscape');

            // Clona a tabela original
            const tabelaOriginal = document.getElementById("minhaTabela");
            const tabelaClone = tabelaOriginal.cloneNode(true);

            // Remove rowspan e replica as células de data
            const rows = Array.from(tabelaClone.tBodies[0].rows);
            const dataMap = [];

            rows.forEach((row, index) => {
                const dataCell = row.querySelector(".data-cell");
                if (dataCell) {
                    const rowspan = parseInt(dataCell.getAttribute("rowspan") || 1);
                    for (let i = 0; i < rowspan; i++) {
                        dataMap[index + i] = dataCell.innerHTML;
                    }
                    dataCell.removeAttribute("rowspan");
                }
            });

            rows.forEach((row, index) => {
                if (!row.querySelector(".data-cell")) {
                    const novaCelula = document.createElement("td");
                    novaCelula.innerHTML = dataMap[index] || "";
                    row.insertBefore(novaCelula, row.firstChild);
                }
            });

            // Cria um elemento temporário para o clone
            const tabelaTemp = document.createElement("table");
            tabelaTemp.innerHTML = tabelaClone.innerHTML;

            // Gera o PDF com a tabela processada
            doc.autoTable({
                html: tabelaTemp,
                startY: 20,
                theme: 'grid',
                headStyles: { fillColor: [76, 175, 80], textColor: 255 },
                styles: {
                    fontSize: 8,
                    cellPadding: 3,
                    overflow: 'linebreak',
                    valign: 'top'
                },
                columnStyles: {
                    4: { cellWidth: 100 } // coluna "Descrição do Chamado"
                },
                didParseCell: function (data) {
                    let rawText = "";

                    if (data.cell.raw instanceof HTMLElement) {
                        rawText = data.cell.raw.textContent || "";
                    } else if (typeof data.cell.raw === "string") {
                        rawText = data.cell.raw;
                    }

                    const diasDaSemana = ["SEGUNDA", "TERÇA", "QUARTA", "QUINTA", "SEXTA"];

                    if (diasDaSemana.some(dia => rawText.includes(dia))) {
                        data.cell.styles.fillColor = [208, 240, 192]; // Verde claro
                        data.cell.styles.fontStyle = 'bold';
                    }
                }
            });

            doc.save("relatorio-tabela.pdf");
        }
    </script>

</body>

</html>